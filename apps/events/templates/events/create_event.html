{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
    {% include 'partials/_head.html' %}
    <title>Criar Evento - Sinapse</title>
    
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    {% include 'partials/_header.html' %}

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Cabeçalho da Página -->
        <div class="text-center mb-12">
            <h1 class="font-mono text-4xl font-bold text-gray-900 mb-4">Criar novo evento</h1>
            <p class="font-mono text-lg text-gray-600 max-w-2xl mx-auto">
                Preencha os dados do seu evento e compartilhe experiências incríveis com a comunidade
            </p>
        </div>

        <!-- Formulário -->
        <div class="bg-white rounded-2xl shadow-lg p-8">
            <form method="POST" action="{% url 'create_event' %}" class="space-y-8">
                {% csrf_token %}
                
                <!-- Exibir erros não relacionados a campos específicos -->
                {% if form.non_field_errors %}
                <div class="font-mono text-sm text-red-600 bg-red-50 p-4 rounded-lg border border-red-200">
                    {% for error in form.non_field_errors %}
                        {{ error }}
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Seção: Informações Básicas -->
                <div class="border-b border-gray-200 pb-8">
                    <h2 class="font-mono text-2xl font-bold text-gray-900 mb-6">Informações Básicas</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Nome do Evento -->
                        <div class="md:col-span-2">
                            <label for="{{ form.name.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.name.label }} *
                            </label>
                            {{ form.name }}
                            {% if form.name.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.name.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Descrição -->
                        <div class="md:col-span-2">
                            <label for="{{ form.description.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.description.label }}
                            </label>
                            {{ form.description }}
                            <div class="font-mono text-xs text-gray-500 mt-2 text-right">
                                <span id="charCount">0</span>/300 caracteres
                            </div>
                            {% if form.description.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.description.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Tópicos -->
                        <div class="md:col-span-2">
                            <label for="{{ form.topics.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.topics.label }} *
                            </label>
                            {{ form.topics }}
                            <p class="font-mono text-xs text-gray-500 mt-2">
                                {{ form.topics.help_text }}
                            </p>
                            {% if form.topics.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.topics.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Seção: Localização -->
                <div class="border-b border-gray-200 pb-8">
                    <h2 class="font-mono text-2xl font-bold text-gray-900 mb-6">Localização</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Rua -->
                        <div class="md:col-span-2">
                            <label for="{{ form.street.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.street.label }} *
                            </label>
                            {{ form.street }}
                            {% if form.street.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.street.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Complemento -->
                        <div class="md:col-span-2">
                            <label for="{{ form.complement.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.complement.label }}
                            </label>
                            {{ form.complement }}
                            {% if form.complement.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.complement.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Cidade -->
                        <div>
                            <label for="{{ form.city.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.city.label }} *
                            </label>
                            {{ form.city }}
                            {% if form.city.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.city.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Estado -->
                        <div>
                            <label for="{{ form.state.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.state.label }} *
                            </label>
                            {{ form.state }}
                            {% if form.state.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.state.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- País -->
                        <div>
                            <label for="{{ form.country.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.country.label }} *
                            </label>
                            {{ form.country }}
                            {% if form.country.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.country.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- CEP -->
                        <div>
                            <label for="{{ form.zip_code.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.zip_code.label }} *
                            </label>
                            {{ form.zip_code }}
                            <p class="font-mono text-xs text-gray-500 mt-2">
                                8 dígitos (sem hífen)
                            </p>
                            {% if form.zip_code.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.zip_code.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Seção: Data e Horário -->
                <div class="border-b border-gray-200 pb-8">
                    <h2 class="font-mono text-2xl font-bold text-gray-900 mb-6">Data e Horário</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Data e Hora de Início -->
                        <div>
                            <label for="{{ form.start_date.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.start_date.label }} *
                            </label>
                            {{ form.start_date }}
                            {% if form.start_date.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.start_date.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Data e Hora de Término -->
                        <div>
                            <label for="{{ form.end_date.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.end_date.label }} *
                            </label>
                            {{ form.end_date }}
                            {% if form.end_date.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.end_date.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Seção: Configurações -->
                <div class="border-b border-gray-200 pb-8">
                    <h2 class="font-mono text-2xl font-bold text-gray-900 mb-6">Configurações</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Limite de Participantes -->
                        <div>
                            <label for="{{ form.participants_limit.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.participants_limit.label }}
                            </label>
                            {{ form.participants_limit }}
                            <p class="font-mono text-xs text-gray-500 mt-2">
                                Digite 0 para evento sem limite
                            </p>
                            {% if form.participants_limit.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.participants_limit.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Categoria -->
                        <div>
                            <label for="{{ form.category.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                                {{ form.category.label }} *
                            </label>
                            {{ form.category }}
                            {% if form.category.errors %}
                            <div class="font-mono text-sm text-red-600 mt-2">
                                {% for error in form.category.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Seção: Imagem do Evento -->
                <div class="pb-8">
                    <h2 class="font-mono text-2xl font-bold text-gray-900 mb-6">Imagem do Evento</h2>
                    
                    <div>
                        <label for="{{ form.image_url.id_for_label }}" class="font-mono text-sm font-medium text-gray-700 block mb-3">
                            {{ form.image_url.label }}
                        </label>
                        {{ form.image_url }}
                        <p class="font-mono text-xs text-gray-500 mt-2">
                            Cole a URL de uma imagem para o evento
                        </p>
                        {% if form.image_url.errors %}
                        <div class="font-mono text-sm text-red-600 mt-2">
                            {% for error in form.image_url.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="flex flex-col sm:flex-row gap-4 justify-end pt-6">
                    <a href="{% url 'events_index' %}" 
                       class="font-mono border border-gray-300 text-gray-700 px-8 py-3 rounded-lg hover:bg-gray-50 transition duration-300 order-2 sm:order-1 text-center">
                        Cancelar
                    </a>
                    <input type="submit" 
                            class="font-mono bg-black text-white px-8 py-3 rounded-lg hover:bg-gray-800 transition duration-300 shadow-lg order-1 sm:order-2">
                </div>
            </form>
        </div>

        <!-- Informações Adicionais -->
        <div class="mt-8 text-center">
            <p class="font-mono text-sm text-gray-500">
                Ao criar um evento, você concorda com nossos 
                <a href="#" class="text-black hover:underline">Termos de Serviço</a> 
                e 
                <a href="#" class="text-black hover:underline">Política de Eventos</a>
            </p>
        </div>
    </main>

    <script>
        // Aplicar classes CSS personalizadas a todos os campos do formulário
        document.addEventListener('DOMContentLoaded', function() {
            // Selecionar todos os inputs, selects e textareas do formulário
            const formElements = document.querySelectorAll('input, select, textarea');
            
            formElements.forEach(element => {
                // Aplicar classes base
                element.classList.add('font-mono', 'w-full', 'px-4', 'py-3', 'border', 'border-gray-300', 'rounded-lg', 'focus:ring-2', 'focus:ring-black', 'focus:border-transparent', 'outline-none', 'transition', 'duration-300');
                
                // Classes específicas para tipos diferentes
                if (element.type === 'checkbox' || element.type === 'radio') {
                    element.classList.remove('w-full', 'px-4', 'py-3', 'border', 'rounded-lg');
                    element.classList.add('rounded', 'border-gray-300', 'text-black', 'focus:ring-black');
                }
                
                if (element.tagName === 'SELECT') {
                    element.classList.add('pr-10'); // Espaço para a seta
                }
                
                if (element.type === 'number') {
                    element.classList.add('appearance-none'); // Remover setas padrão do number
                }
            });

            // Contador de caracteres para descrição
            const textarea = document.getElementById('{{ form.description.id_for_label }}');
            const charCount = document.getElementById('charCount');
            
            if (textarea && charCount) {
                charCount.textContent = textarea.value.length;
                textarea.addEventListener('input', function() {
                    charCount.textContent = this.value.length;
                });
            }

            // Formatação de CEP - apenas números
            const cepInput = document.getElementById('{{ form.zip_code.id_for_label }}');
            if (cepInput) {
                cepInput.addEventListener('input', function() {
                    this.value = this.value.replace(/\D/g, '').substring(0, 8);
                });
            }

            // Validação de datas
            const startDateInput = document.getElementById('{{ form.start_date.id_for_label }}');
            const endDateInput = document.getElementById('{{ form.end_date.id_for_label }}');
            
            if (startDateInput && endDateInput) {
                // Definir data mínima como hoje
                const now = new Date();
                const timezoneOffset = now.getTimezoneOffset() * 60000;
                const localISOTime = new Date(now - timezoneOffset).toISOString().slice(0, 16);
                startDateInput.min = localISOTime;
                
                // Validar que a data final é após a data inicial
                startDateInput.addEventListener('change', function() {
                    endDateInput.min = this.value;
                    if (endDateInput.value && endDateInput.value < this.value) {
                        endDateInput.value = this.value;
                    }
                });
            }

            // Processar tópicos - converter string para array
            const topicsInput = document.getElementById('{{ form.topics.id_for_label }}');
            if (topicsInput) {
                topicsInput.placeholder = 'Ex: Tecnologia, Inovação, IA, Blockchain';
            }

            // Preview de imagem a partir da URL
            const imageUrlInput = document.getElementById('{{ form.image_url.id_for_label }}');
            if (imageUrlInput) {
                imageUrlInput.placeholder = 'https://exemplo.com/imagem.jpg';
            }
        });
    </script>
</body>
</html>